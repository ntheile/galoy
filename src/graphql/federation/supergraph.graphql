
schema
  @link(url: "https://specs.apollo.dev/link/v1.0")
  @link(url: "https://specs.apollo.dev/join/v0.2", for: EXECUTION)
{
  query: Query
  mutation: Mutation
  subscription: Subscription
}

directive @join__field(graph: join__Graph!, requires: join__FieldSet, provides: join__FieldSet, type: String, external: Boolean, override: String, usedOverridden: Boolean) repeatable on FIELD_DEFINITION | INPUT_FIELD_DEFINITION

directive @join__graph(name: String!, url: String!) on ENUM_VALUE

directive @join__implements(graph: join__Graph!, interface: String!) repeatable on OBJECT | INTERFACE

directive @join__type(graph: join__Graph!, key: join__FieldSet, extension: Boolean! = false, resolvable: Boolean! = true) repeatable on OBJECT | INTERFACE | UNION | ENUM | INPUT_OBJECT | SCALAR

directive @link(url: String, as: String, for: link__Purpose, import: [link__Import]) repeatable on SCHEMA

interface Account
  @join__type(graph: GALOY)
{
  csvTransactions(walletIds: [WalletId!]!): String!
  defaultWalletId: WalletId!
  id: ID!
  wallets: [Wallet!]!
}

input AccountUpdateDefaultWalletIdInput
  @join__type(graph: GALOY)
{
  walletId: WalletId!
}

type AccountUpdateDefaultWalletIdPayload
  @join__type(graph: GALOY)
{
  account: ConsumerAccount
  errors: [Error!]!
}

"""An authentication code valid for a single use"""
scalar AuthToken
  @join__type(graph: GALOY)

type AuthTokenPayload
  @join__type(graph: GALOY)
{
  authToken: AuthToken
  errors: [Error!]!
}

"""
A wallet belonging to an account which contains a BTC balance and a list of transactions.
"""
type BTCWallet implements Wallet
  @join__implements(graph: GALOY, interface: "Wallet")
  @join__type(graph: GALOY)
{
  """A balance stored in BTC."""
  balance: SignedAmount!
  id: ID!

  """A list of BTC transactions associated with this wallet."""
  transactions(
    """Returns the items in the list that come after the specified cursor."""
    after: String

    """Returns the items in the list that come before the specified cursor."""
    before: String

    """Returns the first n items from the list."""
    first: Int

    """Returns the last n items from the list."""
    last: Int
  ): TransactionConnection
  walletCurrency: WalletCurrency!
}

type BuildInformation
  @join__type(graph: GALOY)
{
  buildTime: Timestamp
  commitHash: String
  helmRevision: Int
}

type CaptchaCreateChallengePayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  result: CaptchaCreateChallengeResult
}

type CaptchaCreateChallengeResult
  @join__type(graph: GALOY)
{
  challengeCode: String!
  failbackMode: Boolean!
  id: String!
  newCaptcha: Boolean!
}

input CaptchaRequestAuthCodeInput
  @join__type(graph: GALOY)
{
  challengeCode: String!
  phone: Phone!
  secCode: String!
  validationCode: String!
}

"""(Positive) Cent amount (1/100 of a dollar)"""
scalar CentAmount
  @join__type(graph: GALOY)

type CentAmountPayload
  @join__type(graph: GALOY)
{
  amount: CentAmount
  errors: [Error!]!
}

type ConsumerAccount implements Account
  @join__implements(graph: GALOY, interface: "Account")
  @join__type(graph: GALOY)
{
  """
  return CSV stream, base64 encoded, of the list of transactions in the wallet
  """
  csvTransactions(walletIds: [WalletId!]!): String!
  defaultWalletId: WalletId!
  id: ID!
  wallets: [Wallet!]!
}

"""
An alias name that a user can set for a wallet (with which they have transactions)
"""
scalar ContactAlias
  @join__type(graph: GALOY)

type Coordinates
  @join__type(graph: GALOY)
{
  latitude: Float!
  longitude: Float!
}

input DeviceNotificationTokenCreateInput
  @join__type(graph: GALOY)
{
  deviceToken: String!
}

interface Error
  @join__type(graph: GALOY)
{
  message: String!
  path: [String]
}

enum ExchangeCurrencyUnit
  @join__type(graph: GALOY)
{
  BTCSAT
  USDCENT
}

"""
Provides global settings for the application which might have an impact for the user.
"""
type Globals
  @join__type(graph: GALOY)
{
  buildInformation: BuildInformation!

  """
  A list of public keys for the running lightning nodes.
  This can be used to know if an invoice belongs to one of our nodes.
  """
  nodesIds: [String!]!
}

"""Hex-encoded string of 32 bytes"""
scalar Hex32Bytes
  @join__type(graph: GALOY)

union InitiationVia
  @join__type(graph: GALOY)
 = InitiationViaIntraLedger | InitiationViaLn | InitiationViaOnChain

type InitiationViaIntraLedger
  @join__type(graph: GALOY)
{
  counterPartyUsername: Username
  counterPartyWalletId: WalletId
}

type InitiationViaLn
  @join__type(graph: GALOY)
{
  paymentHash: PaymentHash!
}

type InitiationViaOnChain
  @join__type(graph: GALOY)
{
  address: OnChainAddress!
}

type InputError implements Error
  @join__implements(graph: GALOY, interface: "Error")
  @join__type(graph: GALOY)
{
  code: InputErrorCode!
  message: String!
  path: [String]
}

enum InputErrorCode
  @join__type(graph: GALOY)
{
  INVALID_INPUT
  VALUE_NOT_ALLOWED
  VALUE_TOO_LONG
  VALUE_TOO_SHORT
}

input IntraLedgerPaymentSendInput
  @join__type(graph: GALOY)
{
  """Amount in satoshis."""
  amount: SatAmount!

  """Optional memo to be attached to the payment."""
  memo: Memo
  recipientWalletId: WalletId!

  """The wallet ID of the sender."""
  walletId: WalletId!
}

type IntraLedgerUpdate
  @join__type(graph: GALOY)
{
  amount: SatAmount!
  displayCurrencyPerSat: Float!
  txNotificationType: TxNotificationType!
  usdPerSat: Float! @deprecated(reason: "updated over displayCurrencyPerSat")
  walletId: WalletId!
}

input IntraLedgerUsdPaymentSendInput
  @join__type(graph: GALOY)
{
  """Amount in cents."""
  amount: CentAmount!

  """Optional memo to be attached to the payment."""
  memo: Memo
  recipientWalletId: WalletId!

  """The wallet ID of the sender."""
  walletId: WalletId!
}

enum InvoicePaymentStatus
  @join__type(graph: GALOY)
{
  PAID
  PENDING
}

scalar join__FieldSet

enum join__Graph {
  GALOY @join__graph(name: "galoy", url: "http://localhost:4002/graphql")
  MECHANTS @join__graph(name: "mechants", url: "http://localhost:4003/graphql")
}

scalar Language
  @join__type(graph: GALOY)

scalar link__Import

enum link__Purpose {
  """
  `SECURITY` features provide metadata necessary to securely resolve fields.
  """
  SECURITY

  """
  `EXECUTION` features provide metadata necessary for operation execution.
  """
  EXECUTION
}

type LnInvoice
  @join__type(graph: GALOY)
{
  paymentHash: PaymentHash!
  paymentRequest: LnPaymentRequest!
  paymentSecret: LnPaymentSecret!
  satoshis: SatAmount
}

input LnInvoiceCreateInput
  @join__type(graph: GALOY)
{
  """Amount in satoshis."""
  amount: SatAmount!

  """Optional memo for the lightning invoice."""
  memo: Memo

  """Wallet ID for a BTC wallet belonging to the current account."""
  walletId: WalletId!
}

input LnInvoiceCreateOnBehalfOfRecipientInput
  @join__type(graph: GALOY)
{
  """Amount in satoshis."""
  amount: SatAmount!
  descriptionHash: Hex32Bytes

  """Optional memo for the lightning invoice."""
  memo: Memo

  """Wallet ID for a BTC wallet which belongs to any account."""
  recipientWalletId: WalletId!
}

input LnInvoiceFeeProbeInput
  @join__type(graph: GALOY)
{
  paymentRequest: LnPaymentRequest!
  walletId: WalletId!
}

type LnInvoicePayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  invoice: LnInvoice
}

input LnInvoicePaymentInput
  @join__type(graph: GALOY)
{
  """Optional memo to associate with the lightning invoice."""
  memo: Memo

  """Payment request representing the invoice which is being paid."""
  paymentRequest: LnPaymentRequest!

  """
  Wallet ID with sufficient balance to cover amount of invoice.  Must belong to the account of the current user.
  """
  walletId: WalletId!
}

input LnInvoicePaymentStatusInput
  @join__type(graph: GALOY)
{
  paymentRequest: LnPaymentRequest!
}

type LnInvoicePaymentStatusPayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  status: InvoicePaymentStatus
}

type LnNoAmountInvoice
  @join__type(graph: GALOY)
{
  paymentHash: PaymentHash!
  paymentRequest: LnPaymentRequest!
  paymentSecret: LnPaymentSecret!
}

input LnNoAmountInvoiceCreateInput
  @join__type(graph: GALOY)
{
  """Optional memo for the lightning invoice."""
  memo: Memo

  """
  ID for either a USD or BTC wallet belonging to the account of the current user.
  """
  walletId: WalletId!
}

input LnNoAmountInvoiceCreateOnBehalfOfRecipientInput
  @join__type(graph: GALOY)
{
  """Optional memo for the lightning invoice."""
  memo: Memo

  """
  ID for either a USD or BTC wallet which belongs to the account of any user.
  """
  recipientWalletId: WalletId!
}

input LnNoAmountInvoiceFeeProbeInput
  @join__type(graph: GALOY)
{
  amount: SatAmount!
  paymentRequest: LnPaymentRequest!
  walletId: WalletId!
}

type LnNoAmountInvoicePayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  invoice: LnNoAmountInvoice
}

input LnNoAmountInvoicePaymentInput
  @join__type(graph: GALOY)
{
  """Amount to pay in satoshis."""
  amount: SatAmount!

  """Optional memo to associate with the lightning invoice."""
  memo: Memo

  """Payment request representing the invoice which is being paid."""
  paymentRequest: LnPaymentRequest!

  """
  Wallet ID with sufficient balance to cover amount defined in mutation request.  Must belong to the account of the current user.
  """
  walletId: WalletId!
}

input LnNoAmountUsdInvoiceFeeProbeInput
  @join__type(graph: GALOY)
{
  amount: CentAmount!
  paymentRequest: LnPaymentRequest!
  walletId: WalletId!
}

input LnNoAmountUsdInvoicePaymentInput
  @join__type(graph: GALOY)
{
  """Amount to pay in USD cents."""
  amount: CentAmount!

  """Optional memo to associate with the lightning invoice."""
  memo: Memo

  """Payment request representing the invoice which is being paid."""
  paymentRequest: LnPaymentRequest!

  """
  Wallet ID with sufficient balance to cover amount defined in mutation request.  Must belong to the account of the current user.
  """
  walletId: WalletId!
}

scalar LnPaymentPreImage
  @join__type(graph: GALOY)

"""BOLT11 lightning invoice payment request with the amount included"""
scalar LnPaymentRequest
  @join__type(graph: GALOY)

scalar LnPaymentSecret
  @join__type(graph: GALOY)

type LnUpdate
  @join__type(graph: GALOY)
{
  paymentHash: PaymentHash!
  status: InvoicePaymentStatus!
  walletId: WalletId!
}

input LnUsdInvoiceCreateInput
  @join__type(graph: GALOY)
{
  """Amount in USD cents."""
  amount: CentAmount!

  """Optional memo for the lightning invoice."""
  memo: Memo

  """Wallet ID for a USD wallet belonging to the current user."""
  walletId: WalletId!
}

input LnUsdInvoiceCreateOnBehalfOfRecipientInput
  @join__type(graph: GALOY)
{
  """Amount in USD cents."""
  amount: CentAmount!
  descriptionHash: Hex32Bytes

  """
  Optional memo for the lightning invoice. Acts as a note to the recipient.
  """
  memo: Memo

  """Wallet ID for a USD wallet which belongs to the account of any user."""
  recipientWalletId: WalletId!
}

input LnUsdInvoiceFeeProbeInput
  @join__type(graph: GALOY)
{
  paymentRequest: LnPaymentRequest!
  walletId: WalletId!
}

type MapInfo
  @join__type(graph: GALOY)
{
  coordinates: Coordinates!
  title: String!
}

type MapMarker
  @join__type(graph: GALOY)
{
  mapInfo: MapInfo!
  username: Username
}

"""Text field in a lightning payment transaction"""
scalar Memo
  @join__type(graph: GALOY)

type Merchant
  @join__type(graph: MECHANTS, key: "id")
{
  id: ID!
  name: String
  address: String
  acceptsBitcoin: Boolean
}

type MobileVersions
  @join__type(graph: GALOY)
{
  currentSupported: Int!
  minSupported: Int!
  platform: String!
}

type Mutation
  @join__type(graph: GALOY)
{
  accountUpdateDefaultWalletId(input: AccountUpdateDefaultWalletIdInput!): AccountUpdateDefaultWalletIdPayload!
  captchaCreateChallenge: CaptchaCreateChallengePayload!
  captchaRequestAuthCode(input: CaptchaRequestAuthCodeInput!): SuccessPayload!
  deviceNotificationTokenCreate(input: DeviceNotificationTokenCreateInput!): SuccessPayload!

  """
  Actions a payment which is internal to the ledger e.g. it does
  not use onchain/lightning. Returns payment status (success,
  failed, pending, already_paid).
  """
  intraLedgerPaymentSend(input: IntraLedgerPaymentSendInput!): PaymentSendPayload!

  """
  Actions a payment which is internal to the ledger e.g. it does
  not use onchain/lightning. Returns payment status (success,
  failed, pending, already_paid).
  """
  intraLedgerUsdPaymentSend(input: IntraLedgerUsdPaymentSendInput!): PaymentSendPayload!

  """
  Returns a lightning invoice for an associated wallet.
  When invoice is paid the value will be credited to a BTC wallet.
  Expires after 24 hours.
  """
  lnInvoiceCreate(input: LnInvoiceCreateInput!): LnInvoicePayload!

  """
  Returns a lightning invoice for an associated wallet.
  When invoice is paid the value will be credited to a BTC wallet.
  Expires after 24 hours.
  """
  lnInvoiceCreateOnBehalfOfRecipient(input: LnInvoiceCreateOnBehalfOfRecipientInput!): LnInvoicePayload!
  lnInvoiceFeeProbe(input: LnInvoiceFeeProbeInput!): SatAmountPayload!

  """
  Pay a lightning invoice using a balance from a wallet which is owned by the account of the current user.
  Provided wallet can be USD or BTC and must have sufficient balance to cover amount in lightning invoice.
  Returns payment status (success, failed, pending, already_paid).
  """
  lnInvoicePaymentSend(input: LnInvoicePaymentInput!): PaymentSendPayload!

  """
  Returns a lightning invoice for an associated wallet.
  Can be used to receive any supported currency value (currently USD or BTC).
  Expires after 24 hours.
  """
  lnNoAmountInvoiceCreate(input: LnNoAmountInvoiceCreateInput!): LnNoAmountInvoicePayload!

  """
  Returns a lightning invoice for an associated wallet.
  Can be used to receive any supported currency value (currently USD or BTC).
  Expires after 24 hours.
  """
  lnNoAmountInvoiceCreateOnBehalfOfRecipient(input: LnNoAmountInvoiceCreateOnBehalfOfRecipientInput!): LnNoAmountInvoicePayload!
  lnNoAmountInvoiceFeeProbe(input: LnNoAmountInvoiceFeeProbeInput!): SatAmountPayload!

  """
  Pay a lightning invoice using a balance from a wallet which is owned by the account of the current user.
  Provided wallet must be BTC and must have sufficient balance to cover amount specified in mutation request.
  Returns payment status (success, failed, pending, already_paid).
  """
  lnNoAmountInvoicePaymentSend(input: LnNoAmountInvoicePaymentInput!): PaymentSendPayload!
  lnNoAmountUsdInvoiceFeeProbe(input: LnNoAmountUsdInvoiceFeeProbeInput!): CentAmountPayload!

  """
  Pay a lightning invoice using a balance from a wallet which is owned by the account of the current user.
  Provided wallet must be USD and have sufficient balance to cover amount specified in mutation request.
  Returns payment status (success, failed, pending, already_paid).
  """
  lnNoAmountUsdInvoicePaymentSend(input: LnNoAmountUsdInvoicePaymentInput!): PaymentSendPayload!

  """
  Returns a lightning invoice denominated in satoshis for an associated wallet.
  When invoice is paid the equivalent value at invoice creation will be credited to a USD wallet.
  Expires after 5 minutes (short expiry time because there is a USD/BTC exchange rate
  associated with the amount).
  """
  lnUsdInvoiceCreate(input: LnUsdInvoiceCreateInput!): LnInvoicePayload!

  """
  Returns a lightning invoice denominated in satoshis for an associated wallet.
  When invoice is paid the equivalent value at invoice creation will be credited to a USD wallet.
  Expires after 5 minutes (short expiry time because there is a USD/BTC exchange rate
    associated with the amount).
  """
  lnUsdInvoiceCreateOnBehalfOfRecipient(input: LnUsdInvoiceCreateOnBehalfOfRecipientInput!): LnInvoicePayload!
  lnUsdInvoiceFeeProbe(input: LnUsdInvoiceFeeProbeInput!): SatAmountPayload!
  onChainAddressCreate(input: OnChainAddressCreateInput!): OnChainAddressPayload!
  onChainAddressCurrent(input: OnChainAddressCurrentInput!): OnChainAddressPayload!
  onChainPaymentSend(input: OnChainPaymentSendInput!): PaymentSendPayload!
  onChainPaymentSendAll(input: OnChainPaymentSendAllInput!): PaymentSendPayload!
  twoFADelete(input: TwoFADeleteInput!): SuccessPayload!
  twoFAGenerate: TwoFAGeneratePayload!
  twoFASave(input: TwoFASaveInput!): SuccessPayload!
  userContactUpdateAlias(input: UserContactUpdateAliasInput!): UserContactUpdateAliasPayload! @deprecated(reason: "will be moved to AccountContact")
  userLogin(input: UserLoginInput!): AuthTokenPayload!
  userQuizQuestionUpdateCompleted(input: UserQuizQuestionUpdateCompletedInput!): UserQuizQuestionUpdateCompletedPayload!
  userRequestAuthCode(input: UserRequestAuthCodeInput!): SuccessPayload!
  userUpdateLanguage(input: UserUpdateLanguageInput!): UserUpdateLanguagePayload!
  userUpdateUsername(input: UserUpdateUsernameInput!): UserUpdateUsernamePayload! @deprecated(reason: "Username will be moved to @Handle in Accounts. Also SetUsername should be used instead of UpdateUsername to reflect the idempotency of Handles")
}

type MyUpdatesPayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  me: User
  update: UserUpdate
}

"""An address for an on-chain bitcoin destination"""
scalar OnChainAddress
  @join__type(graph: GALOY)

input OnChainAddressCreateInput
  @join__type(graph: GALOY)
{
  walletId: WalletId!
}

input OnChainAddressCurrentInput
  @join__type(graph: GALOY)
{
  walletId: WalletId!
}

type OnChainAddressPayload
  @join__type(graph: GALOY)
{
  address: OnChainAddress
  errors: [Error!]!
}

input OnChainPaymentSendAllInput
  @join__type(graph: GALOY)
{
  address: OnChainAddress!
  memo: Memo
  targetConfirmations: TargetConfirmations = 1
  walletId: WalletId!
}

input OnChainPaymentSendInput
  @join__type(graph: GALOY)
{
  address: OnChainAddress!
  amount: SatAmount!
  memo: Memo
  targetConfirmations: TargetConfirmations = 1
  walletId: WalletId!
}

type OnChainTxFee
  @join__type(graph: GALOY)
{
  amount: SatAmount!
  targetConfirmations: TargetConfirmations!
}

scalar OnChainTxHash
  @join__type(graph: GALOY)

type OnChainUpdate
  @join__type(graph: GALOY)
{
  amount: SatAmount!
  displayCurrencyPerSat: Float!
  txHash: OnChainTxHash!
  txNotificationType: TxNotificationType!
  usdPerSat: Float! @deprecated(reason: "updated over displayCurrencyPerSat")
  walletId: WalletId!
}

"""An authentication code valid for a single use"""
scalar OneTimeAuthCode
  @join__type(graph: GALOY)

"""Information about pagination in a connection."""
type PageInfo
  @join__type(graph: GALOY)
{
  """When paginating forwards, the cursor to continue."""
  endCursor: String

  """When paginating forwards, are there more items?"""
  hasNextPage: Boolean!

  """When paginating backwards, are there more items?"""
  hasPreviousPage: Boolean!

  """When paginating backwards, the cursor to continue."""
  startCursor: String
}

type PaymentError implements Error
  @join__implements(graph: GALOY, interface: "Error")
  @join__type(graph: GALOY)
{
  code: PaymentErrorCode!
  message: String!
  path: [String]
}

enum PaymentErrorCode
  @join__type(graph: GALOY)
{
  ACCOUNT_LOCKED
  INSUFFICIENT_BALANCE
  INVOICE_PAID
  LIMIT_EXCEEDED
  NO_LIQUIDITY
  NO_ROUTE
}

scalar PaymentHash
  @join__type(graph: GALOY)

type PaymentSendPayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  status: PaymentSendResult
}

enum PaymentSendResult
  @join__type(graph: GALOY)
{
  ALREADY_PAID
  FAILURE
  PENDING
  SUCCESS
}

"""Phone number which includes country code"""
scalar Phone
  @join__type(graph: GALOY)

"""
Price amount expressed in base/offset. To calculate, use: `base / 10^offset`
"""
type Price
  @join__type(graph: GALOY)
{
  base: SafeInt!
  currencyUnit: ExchangeCurrencyUnit!
  formattedAmount: String!
  offset: Int!
}

"""The range for the X axis in the BTC price graph"""
enum PriceGraphRange
  @join__type(graph: GALOY)
{
  FIVE_YEARS
  ONE_DAY
  ONE_MONTH
  ONE_WEEK
  ONE_YEAR
}

input PriceInput
  @join__type(graph: GALOY)
{
  amount: SatAmount!
  amountCurrencyUnit: ExchangeCurrencyUnit!
  priceCurrencyUnit: ExchangeCurrencyUnit!
}

type PricePayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  price: Price
}

type PricePoint
  @join__type(graph: GALOY)
{
  price: Price!

  """
  Unix timestamp (number of seconds elapsed since January 1, 1970 00:00:00 UTC)
  """
  timestamp: Timestamp!
}

"""
A public view of a generic wallet which stores value in one of our supported currencies.
"""
type PublicWallet
  @join__type(graph: GALOY)
{
  id: ID!
  walletCurrency: WalletCurrency!
}

type Query
  @join__type(graph: GALOY)
  @join__type(graph: MECHANTS)
{
  accountDefaultWallet(username: Username!, walletCurrency: WalletCurrency): PublicWallet! @join__field(graph: GALOY)
  btcPrice: Price @join__field(graph: GALOY)
  btcPriceList(range: PriceGraphRange!): [PricePoint] @join__field(graph: GALOY)
  businessMapMarkers: [MapMarker] @join__field(graph: GALOY)
  globals: Globals @join__field(graph: GALOY)
  me: User @join__field(graph: GALOY)
  mobileVersions: [MobileVersions] @join__field(graph: GALOY)
  onChainTxFee(address: OnChainAddress!, amount: SatAmount!, targetConfirmations: TargetConfirmations = 1, walletId: WalletId!): OnChainTxFee! @join__field(graph: GALOY)
  quizQuestions: [QuizQuestion] @join__field(graph: GALOY)
  userDefaultWalletId(username: Username!): WalletId! @deprecated(reason: "will be migrated to AccountDefaultWalletId") @join__field(graph: GALOY)
  usernameAvailable(username: Username!): Boolean @join__field(graph: GALOY)
  merchants: [Merchant] @join__field(graph: MECHANTS)
}

type QuizQuestion
  @join__type(graph: GALOY)
{
  """The earn reward in Satoshis for the quiz question"""
  earnAmount: SatAmount!
  id: ID!
}

"""
Non-fractional signed whole numeric value between -(2^53) + 1 and 2^53 - 1
"""
scalar SafeInt
  @join__type(graph: GALOY)

"""(Positive) Satoshi amount"""
scalar SatAmount
  @join__type(graph: GALOY)

type SatAmountPayload
  @join__type(graph: GALOY)
{
  amount: SatAmount
  errors: [Error!]!
}

union SettlementVia
  @join__type(graph: GALOY)
 = SettlementViaIntraLedger | SettlementViaLn | SettlementViaOnChain

type SettlementViaIntraLedger
  @join__type(graph: GALOY)
{
  """
  Settlement destination: Could be null if the payee does not have a username
  """
  counterPartyUsername: Username
  counterPartyWalletId: WalletId
}

type SettlementViaLn
  @join__type(graph: GALOY)
{
  paymentSecret: LnPaymentSecret @deprecated(reason: "Shifting property to 'preImage' to improve granularity of the LnPaymentSecret type")
  preImage: LnPaymentPreImage
}

type SettlementViaOnChain
  @join__type(graph: GALOY)
{
  transactionHash: OnChainTxHash!
}

"""An amount (of a currency) that can be negative (e.g. in a transaction)"""
scalar SignedAmount
  @join__type(graph: GALOY)

type Subscription
  @join__type(graph: GALOY)
{
  lnInvoicePaymentStatus(input: LnInvoicePaymentStatusInput!): LnInvoicePaymentStatusPayload!
  myUpdates: MyUpdatesPayload!
  price(input: PriceInput!): PricePayload!
}

type SuccessPayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  success: Boolean
}

"""
(Positive) Number of blocks in which the transaction is expected to be confirmed
"""
scalar TargetConfirmations
  @join__type(graph: GALOY)

"""
Timestamp field, serialized as Unix time (the number of seconds since the Unix epoch)
"""
scalar Timestamp
  @join__type(graph: GALOY)

"""
Give details about an individual transaction.
Galoy have a smart routing system which is automatically
settling intraledger when both the payer and payee use the same wallet
therefore it's possible the transactions is being initiated onchain
or with lightning but settled intraledger.
"""
type Transaction
  @join__type(graph: GALOY)
{
  createdAt: Timestamp!
  direction: TxDirection!
  id: ID!

  """From which protocol the payment has been initiated."""
  initiationVia: InitiationVia!
  memo: Memo

  """Amount of sats sent or received."""
  settlementAmount: SatAmount!
  settlementFee: SatAmount!

  """Price in USDCENT/SATS at time of settlement."""
  settlementPrice: Price!

  """To which protocol the payment has settled on."""
  settlementVia: SettlementVia!
  status: TxStatus!
}

"""A connection to a list of items."""
type TransactionConnection
  @join__type(graph: GALOY)
{
  """A list of edges."""
  edges: [TransactionEdge!]

  """Information to aid in pagination."""
  pageInfo: PageInfo!
}

"""An edge in a connection."""
type TransactionEdge
  @join__type(graph: GALOY)
{
  """A cursor for use in pagination"""
  cursor: String!

  """The item at the end of the edge"""
  node: Transaction!
}

input TwoFADeleteInput
  @join__type(graph: GALOY)
{
  token: String!
}

type TwoFAGeneratePayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  twoFASecret: TwoFASecret
}

input TwoFASaveInput
  @join__type(graph: GALOY)
{
  secret: String!
  token: String!
}

type TwoFASecret
  @join__type(graph: GALOY)
{
  secret: String!
  uri: String!
}

enum TxDirection
  @join__type(graph: GALOY)
{
  RECEIVE
  SEND
}

enum TxNotificationType
  @join__type(graph: GALOY)
{
  IntraLedgerPayment
  IntraLedgerReceipt
  LnInvoicePaid
  OnchainPayment
  OnchainReceipt
  OnchainReceiptPending
}

enum TxStatus
  @join__type(graph: GALOY)
{
  FAILURE
  PENDING
  SUCCESS
}

"""
A wallet belonging to an account which contains a USD balance and a list of transactions.
"""
type UsdWallet implements Wallet
  @join__implements(graph: GALOY, interface: "Wallet")
  @join__type(graph: GALOY)
{
  balance: SignedAmount!
  id: ID!
  transactions(
    """Returns the items in the list that come after the specified cursor."""
    after: String

    """Returns the items in the list that come before the specified cursor."""
    before: String

    """Returns the first n items from the list."""
    first: Int

    """Returns the last n items from the list."""
    last: Int
  ): TransactionConnection
  walletCurrency: WalletCurrency!
}

type User
  @join__type(graph: GALOY)
  @join__type(graph: MECHANTS, key: "id")
{
  """
  Get single contact details.
  Can include the transactions associated with the contact.
  """
  contactByUsername(username: Username!): UserContact! @deprecated(reason: "will be moved to Accounts") @join__field(graph: GALOY)

  """
  Get full list of contacts.
  Can include the transactions associated with each contact.
  """
  contacts: [UserContact!]! @deprecated(reason: "will be moved to account") @join__field(graph: GALOY)
  createdAt: Timestamp! @join__field(graph: GALOY)
  defaultAccount: Account! @join__field(graph: GALOY)
  id: ID! @join__field(graph: GALOY) @join__field(graph: MECHANTS, external: true)

  """
  Preferred language for user.
  When value is 'default' the intent is to use preferred language from OS settings.
  """
  language: Language! @join__field(graph: GALOY)

  """Phone number with international calling code."""
  phone: Phone @join__field(graph: GALOY)

  """List the quiz questions the user may have completed."""
  quizQuestions: [UserQuizQuestion!]! @deprecated(reason: "will be moved to Accounts") @join__field(graph: GALOY)
  twoFAEnabled: Boolean @join__field(graph: GALOY)

  """Optional immutable user friendly identifier."""
  username: Username @deprecated(reason: "will be moved to @Handle in Account and Wallet") @join__field(graph: GALOY)
  merchants: [Merchant] @join__field(graph: MECHANTS)
}

type UserContact
  @join__type(graph: GALOY)
{
  """
  Alias the user can set for this contact.
  Only the user can see the alias attached to their contact.
  """
  alias: ContactAlias
  id: Username!

  """Paginated list of transactions sent to/from this contact."""
  transactions(
    """Returns the items in the list that come after the specified cursor."""
    after: String

    """Returns the items in the list that come before the specified cursor."""
    before: String

    """Returns the first n items from the list."""
    first: Int

    """Returns the last n items from the list."""
    last: Int
  ): TransactionConnection
  transactionsCount: Int!

  """Actual identifier of the contact."""
  username: Username!
}

input UserContactUpdateAliasInput
  @join__type(graph: GALOY)
{
  alias: ContactAlias!
  username: Username!
}

type UserContactUpdateAliasPayload
  @join__type(graph: GALOY)
{
  contact: UserContact
  errors: [Error!]!
}

input UserLoginInput
  @join__type(graph: GALOY)
{
  code: OneTimeAuthCode!
  phone: Phone!
}

"""Unique identifier of a user"""
scalar Username
  @join__type(graph: GALOY)

type UserQuizQuestion
  @join__type(graph: GALOY)
{
  completed: Boolean!
  question: QuizQuestion!
}

input UserQuizQuestionUpdateCompletedInput
  @join__type(graph: GALOY)
{
  id: ID!
}

type UserQuizQuestionUpdateCompletedPayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  userQuizQuestion: UserQuizQuestion
}

input UserRequestAuthCodeInput
  @join__type(graph: GALOY)
{
  phone: Phone!
}

union UserUpdate
  @join__type(graph: GALOY)
 = IntraLedgerUpdate | LnUpdate | OnChainUpdate | Price

input UserUpdateLanguageInput
  @join__type(graph: GALOY)
{
  language: Language!
}

type UserUpdateLanguagePayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  user: User
}

input UserUpdateUsernameInput
  @join__type(graph: GALOY)
{
  username: Username!
}

type UserUpdateUsernamePayload
  @join__type(graph: GALOY)
{
  errors: [Error!]!
  user: User
}

"""
A generic wallet which stores value in one of our supported currencies.
"""
interface Wallet
  @join__type(graph: GALOY)
{
  balance: SignedAmount!
  id: ID!

  """
  Transactions are ordered anti-chronologically,
  ie: the newest transaction will be first
  """
  transactions(
    """Returns the items in the list that come after the specified cursor."""
    after: String

    """Returns the items in the list that come before the specified cursor."""
    before: String

    """Returns the first n items from the list."""
    first: Int

    """Returns the last n items from the list."""
    last: Int
  ): TransactionConnection
  walletCurrency: WalletCurrency!
}

enum WalletCurrency
  @join__type(graph: GALOY)
{
  BTC
  USD
}

"""Unique identifier of a wallet"""
scalar WalletId
  @join__type(graph: GALOY)